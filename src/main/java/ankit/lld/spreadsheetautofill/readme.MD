Notes & extensibility
Tie-breaks: pick by score; give domain patterns (months/weekdays)
            higher scores (0.95) than arithmetic (0.90) to avoid misclassification.

Geometric / Alphanumerics / Quarters: add new PatternDetector<T> and registerâ€”no engine changes.

TODO: Undo/Redo: wrap writes in a FillCommand (old/new values) and stack them.